# Step管理チェックリスト

## 概要

スクロールテリングシステムでのStep追加・削除・修正時の必須確認事項をチェックリスト形式でまとめました。**すべての項目を確認してから作業を完了してください。**

## Step追加時のチェックリスト

### □ 1. HTMLファイルの更新
- [ ] `index.html`に新しい`<div class="step" data-step="新ID">`を追加
- [ ] `data-step`値が既存のものと重複していない
- [ ] `data-step`値が英数字とハイフンのみ
- [ ] 追加位置が適切（他のstepとの順序）

### □ 2. content.jsonの更新
- [ ] 新しいstep設定オブジェクトを追加
- [ ] `"id"`フィールドがHTMLの`data-step`と一致
- [ ] 必須フィールド（text, chart, map, image）が存在
- [ ] JSON文法が正しい（カンマ、括弧など）

### □ 3. データファイルの準備（チャート使用時）
- [ ] CSVファイルが`data/`フォルダに配置済み
- [ ] ヘッダー行が`year,series,value`形式
- [ ] データに欠損がない
- [ ] ファイル名にスペースや特殊文字が含まれていない

### □ 4. Step番号の整合性確認
- [ ] 全stepの`data-step`値に欠番がない
- [ ] Step表示順序が意図した通り
- [ ] フッター表示step（通常は最終step）が正しく設定されている

## Step削除時のチェックリスト

### □ 1. HTMLファイルの更新
- [ ] 対象の`<div class="step" data-step="削除ID">`を削除
- [ ] 他のstepの`data-step`値は変更不要（IDベースのため）

### □ 2. content.jsonの更新
- [ ] 対象のstep設定オブジェクトを削除
- [ ] JSON文法が正しい（最終要素のカンマ除去など）

### □ 3. 依存関係の確認
- [ ] 削除stepに関連するデータファイルが他で使用されていないか確認
- [ ] JavaScript内での直接参照がないか確認
- [ ] 地図のcountry-episodesなどの動的step生成に影響がないか確認

### □ 4. Step番号の再確認
- [ ] フッター表示stepが正しく機能している
- [ ] Step遷移が正常に動作している
- [ ] 最終stepまで正しく表示される

## Step修正時のチェックリスト

### □ 1. IDの変更（推奨しない）
- [ ] HTMLの`data-step`値を変更
- [ ] content.jsonの`"id"`フィールドを対応変更
- [ ] JavaScript内での直接参照があれば更新
- [ ] **注意**: 可能な限りIDの変更は避ける

### □ 2. コンテンツの修正
- [ ] `text.content`の変更
- [ ] チャート設定の変更
- [ ] レイアウト設定の変更
- [ ] JSON文法の確認

### □ 3. データファイルの変更
- [ ] ファイル名変更時は`dataFile`フィールドも更新
- [ ] 新しいCSVファイルのスキーマ確認
- [ ] 古いファイルの削除またはバックアップ

## 動作確認チェックリスト

### □ 1. ブラウザでの基本確認
- [ ] ページが正常に読み込まれる
- [ ] JavaScriptエラーがコンソールに出力されていない
- [ ] 全stepが順次表示される
- [ ] スクロール遷移が正常に動作する

### □ 2. チャート表示の確認
- [ ] チャートが正しく描画される
- [ ] データが正確に反映されている
- [ ] レスポンシブ対応が正常に動作する
- [ ] ツールチップや凡例が正しく表示される

### □ 3. デュアル・グリッドレイアウトの確認
- [ ] 複数チャートが正しく配置される
- [ ] 各チャートが独立して描画される
- [ ] レイアウト切り替えが正常に動作する
- [ ] エラー状態の表示が適切

### □ 4. 地図・画像表示の確認
- [ ] 地図が正しく表示される
- [ ] 画像が適切に配置される
- [ ] ズーム・パン機能が正常に動作する
- [ ] 都市フォーカス機能が正常に動作する

## エラー発生時の対処手順

### 1. ブラウザコンソールの確認
```
開発者ツール → Console → エラーメッセージの確認
```

### 2. よくあるエラーパターン

#### JSONパースエラー
- [ ] content.jsonの文法確認
- [ ] 最終要素の不要なカンマ除去
- [ ] 文字列の引用符確認

#### データ読み込みエラー
- [ ] CSVファイルの存在確認
- [ ] ファイルパスの確認
- [ ] ヘッダー行の確認

#### Step遷移エラー
- [ ] `data-step`値の重複確認
- [ ] HTML-JSON間のid一致確認
- [ ] Step番号の連続性確認

### 3. バックアップとロールバック
- [ ] 変更前のファイルをバックアップ済み
- [ ] 問題発生時の即座なロールバック準備
- [ ] git commitでのバージョン管理

## 感染症別の特別事項

### エイズ (01_aids)
- [ ] Grid Layoutでの8×2格子設定確認
- [ ] DualLayoutでの若年層データ比較確認
- [ ] カラーテーマ: #ff6b6b (赤系)

### 結核 (02_tuberculosis)  
- [ ] DualLayoutでのインドネシア・ミャンマー比較確認
- [ ] 日本の歴史データ表示確認
- [ ] カラーテーマ: #4ecdc4 (青緑系)

### マラリア (03_malariae)
- [ ] Grid Layoutでの6×2格子設定確認
- [ ] 地域別分布データ確認
- [ ] カラーテーマ: #f4a620 (黄系)

## 最終確認項目

### □ 1. 全感染症での統一性確認
- [ ] 同様の修正を他の感染症にも適用
- [ ] カラーテーマの統一性維持
- [ ] レイアウト設定の一貫性確保

### □ 2. パフォーマンス確認
- [ ] ページ読み込み速度
- [ ] スクロール時の滑らかさ
- [ ] メモリリークの確認

### □ 3. アクセシビリティ確認
- [ ] キーボード操作対応
- [ ] スクリーンリーダー対応
- [ ] 色覚異常への配慮

## 緊急時の連絡事項

### システム障害発生時
1. **即座にバックアップファイルでロールバック**
2. **エラーログとスクリーンショットを保存**
3. **影響範囲を特定（単一感染症 or 全体）**
4. **修正作業は慎重に段階的に実施**

---

**重要**: このチェックリストは必ず印刷またはデジタル版で手元に置き、作業時に一項目ずつ確認してください。確認漏れがシステム全体の障害につながる可能性があります。